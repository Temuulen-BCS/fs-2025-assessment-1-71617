@using Microsoft.AspNetCore.Components

<div class="row g-2 mb-3">
    <div class="col-md-5">
        <input class="form-control"
               placeholder="Search by name or address"
               @bind="Search"
               @bind:event="oninput" />
    </div>

    <div class="col-md-3">
        <select class="form-select" @bind="Status">
            <option value="">All statuses</option>
            <option value="OPEN">Open</option>
            <option value="CLOSED">Closed</option>
        </select>
    </div>

    <div class="col-md-2">
        <input type="number"
               class="form-control"
               min="0"
               placeholder="Min bikes"
               @bind="MinBikes" />
    </div>

    <div class="col-md-2 d-flex gap-2">
        <button class="btn btn-primary flex-fill" @onclick="Apply">Apply</button>
        <button class="btn btn-outline-secondary flex-fill" @onclick="Clear">Clear</button>
    </div>
</div>

@code {
    [Parameter] public string? Search { get; set; }
    [Parameter] public EventCallback<string?> SearchChanged { get; set; }

    [Parameter] public string? Status { get; set; }
    [Parameter] public EventCallback<string?> StatusChanged { get; set; }

    [Parameter] public int? MinBikes { get; set; }
    [Parameter] public EventCallback<int?> MinBikesChanged { get; set; }

    [Parameter] public EventCallback OnApply { get; set; }
    [Parameter] public EventCallback OnClear { get; set; }

    private async Task Apply()
    {
        await SearchChanged.InvokeAsync(Search);
        await StatusChanged.InvokeAsync(Status);
        await MinBikesChanged.InvokeAsync(MinBikes);

        if (OnApply.HasDelegate)
            await OnApply.InvokeAsync();
    }

    private async Task Clear()
    {
        Search = null;
        Status = null;
        MinBikes = null;

        await SearchChanged.InvokeAsync(Search);
        await StatusChanged.InvokeAsync(Status);
        await MinBikesChanged.InvokeAsync(MinBikes);

        if (OnClear.HasDelegate)
            await OnClear.InvokeAsync();
    }
}
